<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Front Desk Admin Panel</title>
    <link href="lib/css/bootstrap.min.css" rel="stylesheet" />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;700&display=swap"
      rel="stylesheet"
    />
    <link
      href="https://www.nerdfonts.com/assets/css/webfont.css"
      rel="stylesheet"
    />
    <script src="lib/js/vue.global.js"></script>
    <script src="lib/js/axios.min.js"></script>
    <script src="lib/js/bootstrap.bundle.min.js"></script>
    <script src="https://js.stripe.com/v3/"></script>
    <link rel="stylesheet" href="styles.css?v=2" />
    <style>
      /* --- FIX FOR VUE MANUAL MODALS (No Backdrop Element) --- */
      /* Since there is no .modal-backdrop div, we dim the .modal container itself */
      #app .modal.show {
        background-color: rgba(0, 0, 0, 0.35) !important; /* Subtle Frost */
        -webkit-backdrop-filter: blur(8px) !important;
        backdrop-filter: blur(8px) !important;
      }
    </style>
  </head>
  <body>
    <div
      id="app"
      class="container-fluid"
      :class="{ 'fab-clearance': activeTab === 'clients' }"
    >
      <nav
        class="navbar navbar-expand-lg navbar-dark bg-primary mb-4"
        v-if="currentView === 'dashboard'"
      >
        <div class="container-fluid">
          <a class="navbar-brand" href="#" style="font-size: 1em">
            <pre class="mb-0 ascii-logo">
‚ñë‚ñà‚ñÄ‚ñÄ‚ñë‚ñà‚ñÄ‚ñÑ‚ñë‚ñà‚ñÄ‚ñà‚ñë‚ñà‚ñÄ‚ñà‚ñë‚ñÄ‚ñà‚ñÄ‚ñë‚ñà‚ñÄ‚ñÑ‚ñë‚ñà‚ñÄ‚ñÄ‚ñë‚ñà‚ñÄ‚ñÄ‚ñë‚ñà‚ñë‚ñà‚ñë‚ñë‚ñë‚ñë‚ñë‚ñà‚ñÄ‚ñà‚ñë‚ñÄ‚ñà‚ñÄ
‚ñë‚ñà‚ñÄ‚ñÄ‚ñë‚ñà‚ñÄ‚ñÑ‚ñë‚ñà‚ñë‚ñà‚ñë‚ñà‚ñë‚ñà‚ñë‚ñë‚ñà‚ñë‚ñë‚ñà‚ñë‚ñà‚ñë‚ñà‚ñÄ‚ñÄ‚ñë‚ñÄ‚ñÄ‚ñà‚ñë‚ñà‚ñÄ‚ñÑ‚ñë‚ñÑ‚ñÑ‚ñÑ‚ñë‚ñà‚ñÄ‚ñà‚ñë‚ñë‚ñà‚ñë
‚ñë‚ñÄ‚ñë‚ñë‚ñë‚ñÄ‚ñë‚ñÄ‚ñë‚ñÄ‚ñÄ‚ñÄ‚ñë‚ñÄ‚ñë‚ñÄ‚ñë‚ñë‚ñÄ‚ñë‚ñë‚ñÄ‚ñÄ‚ñë‚ñë‚ñÄ‚ñÄ‚ñÄ‚ñë‚ñÄ‚ñÄ‚ñÄ‚ñë‚ñÄ‚ñë‚ñÄ‚ñë‚ñë‚ñë‚ñë‚ñë‚ñÄ‚ñë‚ñÄ‚ñë‚ñÄ‚ñÄ‚ñÄ
</pre
            >
          </a>
          <div class="navbar-nav ms-auto d-flex align-items-center gap-3" v-if="currentUser">
            <span class="text-muted small">{{ clients.length }} CLIENTS</span>
            <button
              @click="showSettingsModal = true"
              class="btn btn-sm btn-outline-secondary border-0"
              title="Settings"
            >
              <i class="bi bi-gear"></i>
            </button>
            <button
              @click="showUserProfileModal = true"
              class="btn btn-sm btn-outline-secondary"
              title="User Profile"
            >
              <i class="bi bi-person-circle me-1"></i>
              {{ currentUser.split('@')[0] }}
            </button>
          </div>
        </div>
      </nav>

      <!-- LANDING PAGE -->
      <div v-if="currentView === 'landing'" class="landing-page">
        <!-- Hero Section -->
        <div class="text-center mb-5" style="padding: 60px 0">
          <pre class="ascii-logo mb-4" style="font-size: 1.2em; line-height: 1.2;">
‚ñë‚ñà‚ñÄ‚ñÄ‚ñë‚ñà‚ñÄ‚ñÑ‚ñë‚ñà‚ñÄ‚ñà‚ñë‚ñà‚ñÄ‚ñà‚ñë‚ñÄ‚ñà‚ñÄ‚ñë‚ñà‚ñÄ‚ñÑ‚ñë‚ñà‚ñÄ‚ñÄ‚ñë‚ñà‚ñÄ‚ñÄ‚ñë‚ñà‚ñë‚ñà‚ñë‚ñë‚ñë‚ñë‚ñë‚ñà‚ñÄ‚ñà‚ñë‚ñÄ‚ñà‚ñÄ
‚ñë‚ñà‚ñÄ‚ñÄ‚ñë‚ñà‚ñÄ‚ñÑ‚ñë‚ñà‚ñë‚ñà‚ñë‚ñà‚ñë‚ñà‚ñë‚ñë‚ñà‚ñë‚ñë‚ñà‚ñë‚ñà‚ñë‚ñà‚ñÄ‚ñÄ‚ñë‚ñÄ‚ñÄ‚ñà‚ñë‚ñà‚ñÄ‚ñÑ‚ñë‚ñÑ‚ñÑ‚ñÑ‚ñë‚ñà‚ñÄ‚ñà‚ñë‚ñë‚ñà‚ñë
‚ñë‚ñÄ‚ñë‚ñë‚ñë‚ñÄ‚ñë‚ñÄ‚ñë‚ñÄ‚ñÄ‚ñÄ‚ñë‚ñÄ‚ñë‚ñÄ‚ñë‚ñë‚ñÄ‚ñë‚ñë‚ñÄ‚ñÄ‚ñë‚ñë‚ñÄ‚ñÄ‚ñÄ‚ñë‚ñÄ‚ñÄ‚ñÄ‚ñë‚ñÄ‚ñë‚ñÄ‚ñë‚ñë‚ñë‚ñë‚ñë‚ñÄ‚ñë‚ñÄ‚ñë‚ñÄ‚ñÄ‚ñÄ</pre>
          <h1 class="display-5 fw-bold mb-3" style="color: var(--theme-cyan)">
            Open Source AI Voice Agent Platform
          </h1>
          <p class="lead text-muted mb-4" style="max-width: 700px; margin: 0 auto">
            Build, deploy, and manage intelligent voice agents with full cost transparency.
            <br />Bring your own API keys. Own your data. Control your costs.
          </p>
          <div class="d-flex gap-3 justify-content-center align-items-center">
            <a
              href="https://github.com/stephenschoettler/frontdesk-ai"
              target="_blank"
              class="btn btn-outline-secondary btn-lg"
            >
              <i class="bi bi-github me-2"></i>View on GitHub
            </a>
            <button
              @click="goToRegister"
              class="btn btn-primary btn-lg"
            >
              Get Started <i class="bi bi-arrow-right ms-2"></i>
            </button>
            <button
              @click="goToLogin"
              class="btn btn-outline-primary btn-lg"
            >
              Login
            </button>
          </div>
        </div>

        <!-- Features Grid -->
        <div class="row g-4 mb-5">
          <div class="col-md-4">
            <div class="card h-100">
              <div class="card-body">
                <div class="mb-3">
                  <i class="bi bi-people" style="font-size: 2rem; color: var(--theme-green)"></i>
                </div>
                <h5 class="card-title">Multi-Client Management</h5>
                <p class="card-text text-muted">
                  Create and manage multiple AI voice agents. Each client gets their own phone number, tech stack, and balance tracking.
                </p>
              </div>
            </div>
          </div>
          <div class="col-md-4">
            <div class="card h-100">
              <div class="card-body">
                <div class="mb-3">
                  <i class="bi bi-sliders" style="font-size: 2rem; color: var(--theme-purple)"></i>
                </div>
                <h5 class="card-title">Configurable Tech Stack</h5>
                <p class="card-text text-muted">
                  Choose your STT, LLM, and TTS providers per client. Mix and match Deepgram, OpenAI, Anthropic, Cartesia, and more.
                </p>
              </div>
            </div>
          </div>
          <div class="col-md-4">
            <div class="card h-100">
              <div class="card-body">
                <div class="mb-3">
                  <i class="bi bi-phone" style="font-size: 2rem; color: var(--theme-cyan)"></i>
                </div>
                <h5 class="card-title">Real-Time Monitoring</h5>
                <p class="card-text text-muted">
                  Track active calls, view call logs, and monitor agent performance. Built-in simulator for testing conversations.
                </p>
              </div>
            </div>
          </div>
        </div>

        <!-- Tech Stack -->
        <div class="card mb-5">
          <div class="card-body">
            <h5 class="card-title mb-4 text-center">
              <i class="bi bi-stack me-2"></i>Tech Stack
            </h5>
            <div class="row text-center">
              <div class="col-md-3">
                <div class="mb-2 text-muted small">TELEPHONY</div>
                <div class="fw-bold">Twilio</div>
              </div>
              <div class="col-md-3">
                <div class="mb-2 text-muted small">SPEECH-TO-TEXT</div>
                <div class="fw-bold">Deepgram</div>
              </div>
              <div class="col-md-3">
                <div class="mb-2 text-muted small">LLM</div>
                <div class="fw-bold">OpenAI / Anthropic</div>
              </div>
              <div class="col-md-3">
                <div class="mb-2 text-muted small">TEXT-TO-SPEECH</div>
                <div class="fw-bold">Cartesia / ElevenLabs</div>
              </div>
            </div>
          </div>
        </div>

        <!-- Footer -->
        <div class="text-center text-muted mt-5 pt-5 pb-4">
          <p class="mb-2">
            <i class="bi bi-code-slash"></i> Built with FastAPI, Vue.js, and PostgreSQL
          </p>
          <p class="small">
            Open source under MIT License ‚Ä¢
            <a href="https://github.com/stephenschoettler/frontdesk-ai" target="_blank" class="text-muted">Documentation</a> ‚Ä¢
            <a href="https://github.com/stephenschoettler/frontdesk-ai/issues" target="_blank" class="text-muted">Report Issues</a>
          </p>
        </div>
      </div>

      <!-- AUTH MODAL -->
      <div
        class="modal fade"
        :class="{ show: showAuthModal }"
        :style="{ display: showAuthModal ? 'block' : 'none' }"
        tabindex="-1"
        @click.self="closeAuthModal"
      >
        <div class="modal-dialog modal-dialog-centered">
          <div class="modal-content">
            <div class="modal-header border-0 pb-0">
              <h5 class="modal-title w-100 text-center">
                {{ currentView === 'login' ? 'Login to FrontDesk AI' : 'Create Your Account' }}
              </h5>
              <button
                type="button"
                class="btn-close"
                @click="closeAuthModal"
              ></button>
            </div>
            <div class="modal-body pt-2">
              <form
                @submit.prevent="currentView === 'login' ? login() : register()"
              >
                <!-- Google Sign In Button -->
                <button
                  type="button"
                  @click="initiateGoogleLogin"
                  class="btn btn-outline-dark w-100 mb-3 d-flex align-items-center justify-content-center gap-2"
                  :disabled="googleLoginInProgress"
                  style="border: 2px solid #dadce0; height: 48px;"
                >
                  <svg width="18" height="18" xmlns="http://www.w3.org/2000/svg">
                    <g fill="none" fill-rule="evenodd">
                      <path d="M17.6 9.2l-.1-1.8H9v3.4h4.8C13.6 12 13 13 12 13.6v2.2h3a8.8 8.8 0 0 0 2.6-6.6z" fill="#4285F4"/>
                      <path d="M9 18c2.4 0 4.5-.8 6-2.2l-3-2.2a5.4 5.4 0 0 1-8-2.9H1V13a9 9 0 0 0 8 5z" fill="#34A853"/>
                      <path d="M4 10.7a5.4 5.4 0 0 1 0-3.4V5H1a9 9 0 0 0 0 8l3-2.3z" fill="#FBBC05"/>
                      <path d="M9 3.6c1.3 0 2.5.4 3.4 1.3L15 2.3A9 9 0 0 0 1 5l3 2.4a5.4 5.4 0 0 1 5-3.7z" fill="#EA4335"/>
                    </g>
                  </svg>
                  <span v-if="!googleLoginInProgress">{{ currentView === 'login' ? 'Sign in with Google' : 'Sign up with Google' }}</span>
                  <span v-else>
                    <span class="spinner-border spinner-border-sm me-1"></span>
                    Connecting...
                  </span>
                </button>

                <!-- Divider -->
                <div class="position-relative mb-3">
                  <hr class="my-0">
                  <span class="position-absolute top-50 start-50 translate-middle bg-white px-3 text-muted small">
                    or
                  </span>
                </div>

                <div class="mb-3">
                  <label for="modalAuthEmail" class="form-label">Email address</label>
                  <input
                    type="email"
                    class="form-control"
                    id="modalAuthEmail"
                    v-model="authForm.email"
                    required
                    autofocus
                  />
                </div>
                <div class="mb-3">
                  <label for="modalAuthPassword" class="form-label">Password</label>
                  <input
                    type="password"
                    class="form-control"
                    id="modalAuthPassword"
                    v-model="authForm.password"
                    required
                  />
                </div>
                <div v-if="authSuccess" class="alert alert-success">
                  {{ authSuccess }}
                </div>
                <div v-if="authError" class="alert alert-danger">
                  {{ authError }}
                </div>
                <button type="submit" class="btn btn-primary w-100 mb-3">
                  {{ currentView === 'login' ? 'Login' : 'Create Account' }}
                </button>
                <p class="text-center mb-0">
                  <a href="#" @click.prevent="toggleAuthView" class="text-decoration-none">
                    {{ currentView === 'login' ? 'Need an account? Register' :
                    'Already have an account? Login' }}
                  </a>
                </p>
              </form>
            </div>
          </div>
        </div>
      </div>

      <div v-if="currentView === 'dashboard'" class="row">
        <div class="col-md-12">
          <!-- LIVE ACTIVITY PANEL -->
          <div v-if="activeCalls.length > 0" class="mb-4">
            <div
              class="card border-info"
              style="
                background: rgba(125, 207, 255, 0.05) !important;
                border-style: dashed !important;
              "
            >
              <div
                class="card-body d-flex align-items-center justify-content-between p-3"
              >
                <div class="d-flex align-items-center gap-3">
                  <div
                    class="spinner-grow text-info"
                    role="status"
                    style="width: 1rem; height: 1rem"
                  ></div>
                  <div>
                    <h6 class="text-info mb-0" style="letter-spacing: 2px">
                      ACTIVE AGENT SESSIONS
                    </h6>
                    <small class="text-muted"
                      >Real-time voice transmissions in progress</small
                    >
                  </div>
                </div>
                <div class="d-flex gap-3">
                  <div
                    v-for="call in activeCalls"
                    :key="call.call_id"
                    class="d-flex align-items-center gap-3 px-3 py-2 border border-info rounded bg-dark"
                  >
                    <i class="bi bi-mic-fill text-info"></i>
                    <div>
                      <div class="text-white fw-bold small">
                        {{ call.client_name }}
                      </div>
                      <div
                        class="text-muted small font-monospace"
                        style="font-size: 0.7rem"
                      >
                        {{ call.caller_phone }}
                      </div>
                    </div>
                    <div class="vr mx-2 text-secondary"></div>
                    <div class="font-monospace text-info fw-bold">
                      {{ formatDuration(calculateDuration(call.start_time)) }}
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <ul class="nav nav-tabs mb-4 align-items-end">
            <li class="nav-item">
              <a
                class="nav-link"
                :class="{ active: activeTab === 'clients' }"
                href="#"
                @click.prevent="activeTab = 'clients'"
                >Clients</a
              >
            </li>
            <li class="nav-item">
              <a
                class="nav-link"
                :class="{ active: activeTab === 'contacts' }"
                href="#"
                @click.prevent="activeTab = 'contacts'"
                >Contacts</a
              >
            </li>
            <li class="nav-item">
              <a
                class="nav-link"
                :class="{ active: activeTab === 'logs' }"
                href="#"
                @click.prevent="activeTab = 'logs'"
                >Call Logs</a
              >
            </li>

          </ul>
          <div v-if="activeTab === 'clients'">
            <div class="row mb-3">
              <div class="col-md-6">
                <input
                  v-model="searchQuery"
                  @input="filterClients"
                  type="search"
                  class="form-control"
                  placeholder="Search clients..."
                />
              </div>
              <div class="col-md-3">
                <select
                  v-model="filterStatus"
                  @change="filterClients"
                  class="form-select"
                >
                  <option value="">All Status</option>
                  <option value="active">Active</option>
                  <option value="inactive">Inactive</option>
                </select>
              </div>
              <div class="col-md-3">
                <select
                  v-model="sortBy"
                  @change="sortClients"
                  class="form-select"
                >
                  <option value="name">Sort by Name</option>
                  <option value="created_at">Sort by Created</option>
                </select>
              </div>
            </div>

            <!-- Bulk Actions Toolbar -->
            <div v-if="clients.length > 0" class="d-flex justify-content-between align-items-center mb-4" style="padding: 12px 16px; background: var(--theme-bg-dark); border: 1px solid var(--theme-bg-mid); border-radius: 8px;">
              <div class="d-flex gap-2 align-items-center">
                <button
                  @click="toggleBulkSelect"
                  class="btn btn-sm btn-outline-secondary"
                >
                  <i class="bi bi-check-square me-1"></i>
                  {{ allSelected ? 'DESELECT ALL' : 'SELECT ALL' }}
                </button>
                <span v-if="selectedClients.length > 0" class="text-muted small" style="letter-spacing: 1px;">
                  {{ selectedClients.length }} SELECTED
                </span>
              </div>
              <div v-if="selectedClients.length > 0" class="d-flex gap-2">
                <button
                  @click="bulkDuplicateClients"
                  class="btn btn-sm btn-outline-info"
                >
                  <i class="bi bi-files me-1"></i>
                  DUPLICATE
                </button>
                <button
                  @click="bulkDeleteClients"
                  class="btn btn-sm btn-outline-danger"
                >
                  <i class="bi bi-trash me-1"></i>
                  DELETE
                </button>
              </div>
            </div>

            <div class="row">
              <div
                v-for="client in filteredClients"
                :key="client.id"
                class="col-md-6 col-lg-4 mb-4"
              >
                <div
                  class="card client-card h-100"
                  @click="toggleClientSelection(client.id)"
                  :class="{ 'selected-card': selectedClients.includes(client.id) }"
                >
                  <div
                    class="card-header d-flex justify-content-between align-items-center"
                  >
                    <div class="d-flex align-items-center gap-2">
                      <h5 class="card-title mb-0">
                        {{ formatName(client.name) }}
                      </h5>
                    </div>
                    <button
                      @click.stop="editClient(client)"
                      class="btn btn-sm btn-outline-secondary border-0 p-0 ms-1"
                      title="Edit"
                      style="color: var(--theme-comment)"
                    >
                      <i class="nf nf-fa-pen_to_square"></i>
                    </button>
                  </div>
                  <div class="card-body d-flex flex-column gap-3">
                    <!-- Hyprland Layout: Flex Row -->
                    <div
                      class="d-flex justify-content-between align-items-start"
                    >
                      <!-- Left: Contact Info -->
                      <div class="d-flex flex-column gap-2">
                        <div class="spec-row mb-0" title="Contact Number">
                          <i class="nf nf-fa-phone spec-icon"></i>
                          <span class="spec-value tech-font"
                            >{{ client.cell || 'NO NUMBER' }}</span
                          >
                        </div>

                        <div class="spec-row mb-0" title="Business Hours">
                          <i class="nf nf-fa-clock_o spec-icon"></i>
                          <span class="spec-value">
                            {{ formatHour(client.business_start_hour) }} - {{
                            formatHour(client.business_end_hour) }}
                          </span>
                        </div>

                        <div
                          v-if="hasScheduling(client)"
                          class="spec-row mb-0"
                          title="Calendar ID"
                        >
                          <i class="nf nf-fa-calendar_check_o spec-icon"></i>
                          <span class="spec-value">
                            {{ client.calendar_id ?
                            truncateId(client.calendar_id) : '‚ö†Ô∏è MISSING ID' }}
                          </span>
                        </div>

                        <!-- Calendar Auth Status (inline with calendar info) -->
                        <div
                          v-if="hasScheduling(client) && client.calendar_auth_status"
                          class="spec-row mb-0"
                          :title="client.calendar_auth_status.credential_type === 'oauth' ? 'OAuth 2.0 Authentication' : client.calendar_auth_status.credential_type === 'service_account' ? 'Service Account Authentication' : 'Using Global Fallback'"
                        >
                          <i class="nf nf-fa-key spec-icon"></i>
                          <span class="spec-value">
                            <span
                              v-if="client.calendar_auth_status.has_credentials"
                              :class="client.calendar_auth_status.credential_type === 'oauth' ? 'text-success' : 'text-info'"
                            >
                              {{ client.calendar_auth_status.credential_type === 'oauth' ? '‚úì OAuth' : '‚úì Service Account' }}
                            </span>
                            <span
                              v-else-if="client.calendar_auth_status.fallback_available"
                              class="text-warning"
                            >
                              ‚ö† Using Fallback
                            </span>
                            <span
                              v-else
                              class="text-danger"
                            >
                              ‚ùå Not Configured
                            </span>
                          </span>
                        </div>

                        <div class="spec-row mb-0" title="Created Date">
                          <i class="nf nf-fa-calendar_plus_o spec-icon"></i>
                          <span class="spec-value small">
                            {{ formatDate(client.created_at) }}
                          </span>
                        </div>
                      </div>

                      <!-- Right: Badges (Stacked) -->
                      <div class="d-flex flex-column gap-2 align-items-end">
                        <!-- Tech Stack Badges -->
                        <div
                          class="d-flex gap-1 justify-content-end flex-wrap"
                          style="max-width: 150px"
                        >
                          <span class="sst-badge" title="STT Model">
                            <i class="nf nf-fa-microphone"></i>
                            {{ formatSttModel(client.stt_model) }}
                          </span>
                          <span class="model-badge" title="LLM Model">
                            <i class="nf nf-fa-robot"></i>
                            {{ client.llm_model.split('/')[1] ||
                            client.llm_model }}
                          </span>
                          <span class="voice-badge" title="TTS Voice">
                            <i class="nf nf-md-waveform"></i>
                            {{ getVoiceName(client.tts_voice_id) }}
                          </span>
                        </div>

                        <!-- Tool Badges (Pills) -->
                        <div class="d-flex gap-1 justify-content-end flex-wrap">
                          <span
                            class="tool-badge"
                            :class="{ 'disabled': !hasScheduling(client) }"
                            title="Scheduling"
                          >
                            <i class="nf nf-md-calendar_range"></i>
                          </span>
                          <span
                            class="tool-badge"
                            :class="{ 'disabled': !hasMemory(client) }"
                            title="Memory"
                          >
                            <i class="nf nf-fa-brain"></i>
                          </span>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div
                    class="card-footer d-flex justify-content-between align-items-center"
                  >
                    <!-- PENDING PROVISIONING STATE -->
                    <div
                      v-if="!client.cell"
                      class="d-flex align-items-center gap-2 w-100 justify-content-center"
                    >
                      <button
                        @click.stop="openProvisionModal(client)"
                        class="btn btn-sm btn-primary fw-bold w-100"
                        style="box-shadow: 0 0 10px rgba(13, 110, 253, 0.5)"
                      >
                        üì¢ CLAIM NUMBER
                      </button>
                    </div>

                    <!-- ACTIVE STATE -->
                    <div
                      v-else
                      class="d-flex align-items-center justify-content-between w-100"
                    >
                      <span
                        class="fuel-gauge clickable-fuel"
                        :class="(client.balance_seconds || 0) < 60 ? 'fuel-low' : 'fuel-cyan'"
                        @click.stop="openTopUpModal(client)"
                        title="Click to Add Funds"
                        style="cursor: pointer"
                      >
                        <i class="nf nf-fa-hourglass_half me-1"></i>
                        {{ formatDuration(client.balance_seconds || 0) }}
                      </span>

                      <div class="d-flex gap-2">
                        <button
                          @click.stop="openSimulator(client)"
                          class="btn btn-sm btn-outline-secondary border-0"
                          title="Launch Simulator"
                        >
                          <i class="nf nf-fa-headset"></i>
                        </button>

                        <button
                          @click.stop="toggleClientStatus(client)"
                          class="btn btn-sm status-toggle-btn"
                          :class="client.is_active ? 'btn-outline-success' : 'btn-outline-danger'"
                          :title="client.is_active ? 'Disable Client' : 'Enable Client'"
                        >
                          <span class="status-icon"
                            >{{ client.is_active ? '‚óè' : '‚óã' }}</span
                          >
                        </button>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <nav v-if="totalPages > 1" aria-label="Client pagination">
              <ul class="pagination justify-content-center">
                <li class="page-item" :class="{ disabled: currentPage === 1 }">
                  <a
                    class="page-link"
                    href="#"
                    @click.prevent="currentPage--"
                    v-if="currentPage > 1"
                    >Previous</a
                  >
                </li>
                <li
                  v-for="page in visiblePages"
                  :key="page"
                  class="page-item"
                  :class="{ active: page === currentPage }"
                >
                  <a
                    class="page-link"
                    href="#"
                    @click.prevent="currentPage = page"
                    >{{ page }}</a
                  >
                </li>
                <li
                  class="page-item"
                  :class="{ disabled: currentPage === totalPages }"
                >
                  <a
                    class="page-link"
                    href="#"
                    @click.prevent="currentPage++"
                    v-if="currentPage < totalPages"
                    >Next</a
                  >
                </li>
              </ul>
            </nav>
          </div>

          <!-- Subscription Modal -->
          <div
            class="modal fade"
            :class="{ show: showSubscriptionModal }"
            :style="{ display: showSubscriptionModal ? 'block' : 'none' }"
            tabindex="-1"
          >
            <div class="modal-dialog modal-lg">
              <div class="modal-content">
                <div
                  class="modal-header border-bottom border-opacity-0"
                >
                  <h5 class="modal-title text-warning">
                    <i class="bi bi-gem me-2"></i>Select Your AI Agent Plan
                  </h5>
                  <button
                    type="button"
                    class="btn-close btn-close-white"
                    @click="cancelSubscription"
                    aria-label="Close"
                  ></button>
                </div>
                <div class="modal-body p-4">
                  <p class="text-center text-muted mb-4">
                    Subscribe to activate your agent and provision a phone
                    number.
                  </p>
                  <div class="row g-4">
                    <!-- Starter -->
                    <div class="col-md-4">
                      <div
                        class="card h-100 border-opacity-0 bg-dark"
                      >
                        <div
                          class="card-header text-center bg-transparent border-0 pt-4"
                        >
                          <h5 class="text-muted">STARTER</h5>
                          <h2 class="display-6 fw-bold text-fg">
                            $20<span class="fs-6 text-muted">/mo</span>
                          </h2>
                          <span class="text-muted small">100 Minutes</span>
                        </div>
                        <div class="card-footer bg-transparent border-0 pb-4">
                          <button
                            @click="selectSubscription('starter')"
                            class="btn btn-outline-secondary w-100"
                          >
                            Subscribe
                          </button>
                        </div>
                      </div>
                    </div>

                    <!-- Growth -->
                    <div class="col-md-4">
                      <div
                        class="card h-100 border-success border-opacity-50"
                        style="background: rgba(25, 135, 84, 0.1)"
                      >
                        <div
                          class="card-header text-center bg-transparent border-0 pt-4"
                        >
                          <h5 class="text-success">GROWTH</h5>
                          <h2 class="display-6 fw-bold text-white">
                            $50<span class="fs-6 text-white-50">/mo</span>
                          </h2>
                          <span class="text-success small fw-bold"
                            >300 Minutes</span
                          >
                        </div>
                        <div class="card-footer bg-transparent border-0 pb-4">
                          <button
                            @click="selectSubscription('growth')"
                            class="btn btn-success w-100"
                          >
                            Subscribe
                          </button>
                        </div>
                      </div>
                    </div>

                    <!-- Power -->
                    <div class="col-md-4">
                      <div
                        class="card h-100 border-warning border-opacity-50 bg-dark position-relative overflow-hidden"
                      >
                        <div
                          class="position-absolute top-0 end-0 bg-warning text-dark px-3 py-1 small fw-bold"
                          style="border-bottom-left-radius: 8px"
                        >
                          BEST VALUE
                        </div>
                        <div
                          class="card-header text-center bg-transparent border-0 pt-4"
                        >
                          <h5 class="text-warning">POWER</h5>
                          <h2 class="display-6 fw-bold text-fg">
                            $100<span class="fs-6 text-muted">/mo</span>
                          </h2>
                          <span class="text-warning small fw-bold"
                            >600 Minutes</span
                          >
                        </div>
                        <div class="card-footer bg-transparent border-0 pb-4">
                          <button
                            @click="selectSubscription('power')"
                            class="btn btn-outline-warning w-100"
                          >
                            Subscribe
                          </button>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Provisioning Modal -->
          <div
            class="modal fade"
            :class="{ show: showProvisionModal }"
            :style="{ display: showProvisionModal ? 'block' : 'none' }"
            tabindex="-1"
          >
            <div class="modal-dialog">
              <div class="modal-content">
                <div class="modal-header">
                  <h5 class="modal-title">Claim Phone Number</h5>
                  <button
                    type="button"
                    class="btn-close"
                    @click="closeProvisionModal"
                  ></button>
                </div>
                <div class="modal-body">
                  <div v-if="provisioningClient">
                    <p class="text-muted">
                      Select a phone number for
                      <strong>{{ provisioningClient.name }}</strong>.
                    </p>

                    <div class="input-group mb-3">
                      <input
                        v-model="searchAreaCode"
                        type="text"
                        class="form-control"
                        placeholder="Area Code (e.g. 415)"
                        maxlength="3"
                        @keyup.enter="searchNumbers"
                      />
                      <button
                        @click.prevent="searchNumbers"
                        class="btn btn-outline-primary"
                        type="button"
                        :disabled="searchingNumbers || !searchAreaCode"
                      >
                        <span
                          v-if="searchingNumbers"
                          class="spinner-border spinner-border-sm"
                          role="status"
                          aria-hidden="true"
                        ></span>
                        <span v-else>Search</span>
                      </button>
                    </div>

                    <div v-if="availableNumbers.length > 0" class="list-group">
                      <button
                        v-for="num in availableNumbers"
                        :key="num"
                        @click="confirmNumber(provisioningClient, num)"
                        class="list-group-item list-group-item-action d-flex justify-content-between align-items-center"
                      >
                        {{ num }}
                        <span class="badge bg-primary rounded-pill">Claim</span>
                      </button>
                    </div>

                    <div
                      v-else-if="!searchingNumbers && searchAreaCode && availableNumbers.length === 0"
                      class="text-muted text-center"
                    >
                      No numbers found. Try a different area code.
                    </div>
                    <div v-else class="text-muted text-center small">
                      Enter an area code to search available Twilio numbers.
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Simulator Modal -->
          <div
            class="modal fade"
            id="simulatorModal"
            tabindex="-1"
            aria-hidden="true"
          >
            <div class="modal-dialog modal-dialog-centered">
              <div class="modal-content bg-dark border-secondary shadow-lg">
                <div
                  class="modal-header border-bottom border-opacity-0"
                >
                  <h5 class="modal-title text-success font-monospace">
                    <i class="bi bi-terminal-fill me-2"></i>AGENT SIMULATOR
                  </h5>
                  <button
                    type="button"
                    class="btn-close btn-close-white"
                    @click="stopSimulation"
                  ></button>
                </div>
                <div class="modal-body text-center py-5">
                  <div v-if="simulatingClient">
                    <h4 class="text-fg mb-4">{{ simulatingClient.name }}</h4>

                    <div class="simulator-status mb-5">
                      <div class="status-circle-container mb-3">
                        <div
                          class="status-circle"
                          :class="{'active': isSimulating}"
                        ></div>
                      </div>
                      <div
                        class="font-monospace small text-uppercase"
                        :class="isSimulating ? 'text-success' : 'text-muted'"
                      >
                        {{ isSimulating ? 'LINK ACTIVE // TRANSMITTING' :
                        'DISCONNECTED' }}
                      </div>
                    </div>

                    <div class="d-grid gap-2 col-8 mx-auto">
                      <button
                        v-if="!isSimulating"
                        @click="startSimulation"
                        class="btn btn-success btn-lg font-monospace"
                      >
                        <i class="bi bi-power me-2"></i>INITIALIZE LINK
                      </button>
                      <button
                        v-else
                        @click="stopSimulation"
                        class="btn btn-danger btn-lg font-monospace"
                      >
                        <i class="bi bi-stop-circle me-2"></i>TERMINATE LINK
                      </button>
                    </div>

                    <div class="mt-4 text-muted small font-monospace">
                      <i class="bi bi-info-circle me-1"></i>
                      Usage is billed to client balance.
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div v-if="activeTab === 'contacts'" class="contacts-tab">
            <div class="row mb-3">
              <div class="col-md-4">
                <input
                  v-model="contactSearchQuery"
                  type="search"
                  class="form-control"
                  placeholder="Search contacts..."
                />
              </div>

              <div class="col-md-3">
                <select v-model="contactFilterClient" class="form-select">
                  <option value="">All Clients</option>
                  <option
                    v-for="client in clients"
                    :key="client.id"
                    :value="client.id"
                  >
                    {{ client.name }}
                  </option>
                </select>
              </div>
            </div>

            <!-- Bulk Actions Toolbar -->
            <div v-if="contacts.length > 0" class="d-flex justify-content-between align-items-center mb-4" style="padding: 12px 16px; background: var(--theme-bg-dark); border: 1px solid var(--theme-bg-mid); border-radius: 8px;">
              <div class="d-flex gap-2 align-items-center">
                <button
                  @click="toggleSelectAllContacts"
                  class="btn btn-sm btn-outline-secondary"
                >
                  <i class="bi bi-check-square me-1"></i>
                  {{ allContactsSelected ? 'DESELECT ALL' : 'SELECT ALL' }}
                </button>
                <span v-if="selectedContacts.length > 0" class="text-muted small">
                  {{ selectedContacts.length }} selected
                </span>
              </div>
              <div v-if="selectedContacts.length > 0" class="d-flex gap-2">
                <template v-if="editingContactPhone && selectedContacts.includes(editingContactPhone)">
                  <button
                    @click="saveInlineEdit(contacts.find(c => c.phone === editingContactPhone))"
                    class="btn btn-sm btn-outline-success"
                  >
                    <i class="bi bi-check-lg me-1"></i>
                    SAVE
                  </button>
                  <button
                    @click="cancelInlineEdit"
                    class="btn btn-sm btn-outline-secondary"
                  >
                    <i class="bi bi-x me-1"></i>
                    CANCEL
                  </button>
                </template>
                <template v-else>
                  <button
                    v-if="selectedContacts.length === 1"
                    @click="startInlineEdit(contacts.find(c => c.phone === selectedContacts[0]))"
                    class="btn btn-sm btn-outline-primary"
                  >
                    <i class="bi bi-pencil-square me-1"></i>
                    EDIT
                  </button>
                  <button
                    v-if="selectedContacts.length === 1"
                    @click="viewContactHistory(contacts.find(c => c.phone === selectedContacts[0]))"
                    class="btn btn-sm btn-outline-info"
                  >
                    <i class="bi bi-clock-history me-1"></i>
                    HISTORY
                  </button>
                  <button
                    @click="bulkDeleteContacts"
                    class="btn btn-sm btn-outline-danger"
                  >
                    <i class="bi bi-trash me-1"></i>
                    DELETE
                  </button>
                </template>
              </div>
            </div>

            <div class="table-responsive">
              <table class="table table-custom">
                <thead>
                  <tr>
                    <th>Name</th>
                    <th>Phone Number</th>
                    <th>Client</th>
                    <th>Last Contact</th>
                  </tr>
                </thead>
                <tbody>
                  <tr v-if="isLoading">
                    <td colspan="4" class="text-center p-5">
                      <div
                        class="h5 text-success"
                        style="
                          letter-spacing: 2px;
                          animation: pulse 1s infinite;
                        "
                      >
                        &gt;&gt; ACCESSING DATABASE...
                      </div>
                    </td>
                  </tr>
                  <tr
                    v-else
                    v-for="contact in filteredContacts"
                    :key="contact.phone"
                    @click="toggleContactSelection(contact.phone)"
                    :class="{ 'selected': selectedContacts.includes(contact.phone) }"
                    style="cursor: pointer"
                  >
                    <td class="text-blue">
                      <span
                        v-if="editingContactPhone !== contact.phone"
                        class="fw-bold"
                        >{{ contact.name }}</span
                      >
                      <input
                        v-else
                        v-model="tempContactName"
                        class="table-inline-input text-blue"
                        @click.stop
                        @keyup.enter="saveInlineEdit(contact)"
                        @keyup.esc="cancelInlineEdit()"
                        autofocus
                      />
                    </td>

                    <td class="text-fg fw-bold" style="letter-spacing: 1px">
                      {{ contact.phone }}
                    </td>

                    <td
                      class="text-purple text-uppercase"
                      style="font-size: 0.85rem; letter-spacing: 0.5px"
                    >
                      {{ contact.client_name }}
                    </td>

                    <td class="text-fg small">
                      {{ formatDate(contact.last_contact) }}
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>

          <div v-if="activeTab === 'logs'" class="logs-tab">
            <!-- Expanded Transcript View -->
            <div
              v-if="transcriptExpanded && selectedTranscript"
              class="expanded-transcript"
            >
              <div class="card h-100">
                <div
                  class="card-header d-flex justify-content-between align-items-center bg-transparent border-bottom border-opacity-0"
                >
                  <div class="d-flex align-items-center gap-3">
                    <h5
                      class="mb-0 text-muted text-uppercase"
                      style="letter-spacing: 2px"
                    >
                      <i class="bi bi-chat-text me-2"></i> Transcript
                    </h5>
                    <span
                      class="text-purple"
                      style="font-size: 0.9rem; letter-spacing: 1px"
                    >
                      {{ selectedTranscript.client_name }}
                      <span class="text-muted">/</span> {{
                      selectedTranscript.phone }}
                    </span>
                  </div>
                  <button
                    @click="toggleTranscriptExpansion"
                    class="btn btn-sm btn-outline-primary border-0 p-1"
                    title="Exit Full Screen"
                  >
                    <i
                      class="bi bi-fullscreen-exit"
                      style="font-size: 1.2rem"
                    ></i>
                  </button>
                </div>

                <div class="card-body p-0" style="overflow-y: hidden">
                  <div
                    class="conversation-transcript expanded h-100 p-3"
                    style="overflow-y: auto"
                  >
                    <template
                      v-for="(message, index) in selectedTranscript.transcript"
                      :key="index"
                    >
                      <div v-if="message.role === 'user'" class="message user">
                        <div
                          class="d-flex justify-content-between align-items-start"
                        >
                          <strong>Caller:</strong>
                          <small class="text-muted"
                            >{{ formatTimestamp(message.timestamp) }}</small
                          >
                        </div>
                        <p>{{ message.content }}</p>
                      </div>

                      <div
                        v-else-if="message.role === 'assistant' && message.content"
                        class="message assistant"
                      >
                        <div
                          class="d-flex justify-content-between align-items-start"
                        >
                          <strong>Assistant:</strong>
                          <small class="text-muted"
                            >{{ formatTimestamp(message.timestamp) }}</small
                          >
                        </div>
                        <p>{{ message.content }}</p>
                      </div>

                      <div
                        v-if="message.role === 'assistant' && message.tool_calls"
                        class="message tool msg-action"
                      >
                        <div
                          class="d-flex justify-content-between align-items-start"
                        >
                          <strong style="color: var(--theme-orange)"
                            >‚ö° System Action:</strong
                          >
                          <small class="text-muted"
                            >{{ formatTimestamp(message.timestamp) }}</small
                          >
                        </div>
                        <div
                          v-for="tool in message.tool_calls"
                          :key="tool.id"
                          class="mb-1"
                        >
                          <span class="text-warning"
                            >{{ tool.function.name }}</span
                          >
                          <span class="text-success"
                            >({{ tool.function.arguments }})</span
                          >
                        </div>
                      </div>

                      <div
                        v-else-if="message.role === 'tool'"
                        class="message tool msg-result"
                      >
                        <div
                          class="d-flex justify-content-between align-items-start"
                        >
                          <strong style="color: var(--theme-green)"
                            >‚úì Tool Result:</strong
                          >
                          <small class="text-muted"
                            >{{ formatTimestamp(message.timestamp) }}</small
                          >
                        </div>
                        <p style="white-space: pre-wrap">
                          {{ message.content }}
                        </p>
                      </div>
                    </template>

                    <div
                      v-if="!selectedTranscript.transcript || selectedTranscript.transcript.length === 0"
                      class="text-muted text-center mt-4"
                    >
                      No transcript available.
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Normal Logs View -->
            <div v-else class="logs-view">
              <div class="row mb-3">
                <div class="col-md-4">
                  <input
                    v-model="logSearchQuery"
                    type="search"
                    class="form-control"
                    placeholder="Search logs..."
                  />
                </div>
                <div class="col-md-3">
                  <select v-model="logFilterClient" class="form-select">
                    <option value="">All Clients</option>
                    <option
                      v-for="client in clients"
                      :key="client.id"
                      :value="client.id"
                    >
                      {{ client.name }}
                    </option>
                  </select>
                </div>
              </div>
              <!-- Bulk Actions Toolbar -->
              <div
                v-if="callLogs.length > 0"
                class="d-flex justify-content-between align-items-center mb-4"
                style="padding: 12px 16px; background: var(--theme-bg-dark); border: 1px solid var(--theme-bg-mid); border-radius: 8px;"
              >
                <div class="d-flex gap-2 align-items-center">
                  <button
                    @click="toggleSelectAllCallLogs"
                    class="btn btn-sm btn-outline-secondary"
                  >
                    <i class="bi bi-check-square me-1"></i>
                    {{ selectAllCallLogs ? "DESELECT ALL" : "SELECT ALL" }}
                  </button>
                  <span
                    v-if="selectedCallLogs.length > 0"
                    class="text-muted small"
                  >
                    {{ selectedCallLogs.length }} selected
                  </span>
                </div>
                <div v-if="selectedCallLogs.length > 0" class="d-flex gap-2">
                  <button
                    @click="bulkDeleteCallLogs"
                    class="btn btn-sm btn-outline-danger"
                  >
                    <i class="bi bi-trash me-1"></i> DELETE
                  </button>
                </div>
              </div>
              <div class="row">
                <div :class="selectedTranscript ? 'col-md-6' : 'col-md-12'">
                  <div class="table-responsive">
                    <table class="table table-custom">
                      <thead>
                        <tr>
                          <th class="text-center" style="width: 60px"></th>
                          <th>Date/Time</th>
                          <th>Client</th>
                          <th>Contact</th>
                          <th>Duration</th>
                          <th>Status</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr v-if="isLoading">
                          <td colspan="6" class="text-center p-5">
                            <div
                              class="h5 text-success"
                              style="
                                letter-spacing: 2px;
                                animation: pulse 1s infinite;
                              "
                            >
                              &gt;&gt; ACCESSING DATABASE...
                            </div>
                          </td>
                        </tr>
                        <tr
                          v-else
                          v-for="log in filteredCallLogs"
                          :key="log.id"
                          @click="selectTranscript(log)"
                          :class="{ 'selected': selectedTranscript?.id === log.id }"
                          style="cursor: pointer"
                        >
                          <td class="text-center" @click.stop>
                            <input
                              type="checkbox"
                              v-model="selectedCallLogs"
                              :value="log.id"
                              class="form-check-input"
                              title="Select this log"
                            />
                          </td>

                          <td
                            class="text-fg"
                            style="font-size: 0.9rem; letter-spacing: 0.5px"
                          >
                            {{ formatDate(log.timestamp) }}
                          </td>

                          <td
                            class="text-purple text-uppercase"
                            style="
                              font-size: 0.8rem;
                              letter-spacing: 0.5px;
                              font-weight: 600;
                            "
                          >
                            {{ log.client_name }}
                          </td>

                          <td @click.stop>
                            <a
                              href="#"
                              @click.prevent="jumpToContact(log.phone)"
                              class="text-decoration-none text-blue hover-underline fw-bold"
                              title="Jump to Contact History"
                            >
                              {{ formatName(getContactName(log.phone)) }}
                            </a>
                          </td>

                          <td
                            class="text-fg small"
                            style="font-family: &quot;JetBrains Mono&quot;"
                          >
                            {{ formatDuration(log.duration) }}
                          </td>

                          <td
                            class="text-success small fw-bold text-uppercase"
                            style="letter-spacing: 1px"
                          >
                            {{ log.status }}
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                </div>
                <div class="col-md-6" v-if="selectedTranscript">
                  <div class="card">
                    <div
                      class="card-header d-flex justify-content-between align-items-center bg-transparent border-bottom border-opacity-0"
                    >
                      <h6
                        class="mb-0 text-muted text-uppercase"
                        style="letter-spacing: 2px"
                      >
                        <i class="bi bi-chat-text me-2"></i> Transcript
                      </h6>

                      <div class="d-flex gap-2">
                        <button
                          @click="toggleTranscriptExpansion"
                          class="btn btn-sm btn-outline-primary border-0 p-1"
                          title="Expand View"
                        >
                          <i
                            class="bi bi-arrows-fullscreen"
                            style="font-size: 1rem"
                          ></i>
                        </button>
                        <button
                          @click="selectedTranscript = null"
                          class="btn btn-sm btn-outline-secondary border-0 p-1"
                          title="Close Transcript"
                        >
                          <i class="bi bi-x-lg" style="font-size: 1rem"></i>
                        </button>
                      </div>
                    </div>
                    <div class="card-body">
                      <div class="conversation-transcript">
                        <template
                          v-for="(message, index) in selectedTranscript.transcript"
                          :key="index"
                        >
                          <div
                            v-if="message.role === 'user'"
                            class="message user"
                          >
                            <div
                              class="d-flex justify-content-between align-items-start"
                            >
                              <strong>Caller:</strong>
                              <small class="text-muted"
                                >{{ formatTimestamp(message.timestamp) }}</small
                              >
                            </div>
                            <p>{{ message.content }}</p>
                          </div>

                          <div
                            v-else-if="message.role === 'assistant' && message.content"
                            class="message assistant"
                          >
                            <div
                              class="d-flex justify-content-between align-items-start"
                            >
                              <strong>Assistant:</strong>
                              <small class="text-muted"
                                >{{ formatTimestamp(message.timestamp) }}</small
                              >
                            </div>
                            <p>{{ message.content }}</p>
                          </div>

                          <div
                            v-if="message.role === 'assistant' && message.tool_calls"
                            class="message tool msg-action"
                          >
                            <div
                              class="d-flex justify-content-between align-items-start"
                            >
                              <strong style="color: var(--theme-orange)"
                                >‚ö° System Action:</strong
                              >
                              <small class="text-muted"
                                >{{ formatTimestamp(message.timestamp) }}</small
                              >
                            </div>
                            <div
                              v-for="tool in message.tool_calls"
                              :key="tool.id"
                              class="mb-1"
                            >
                              <span class="text-warning"
                                >{{ tool.function.name }}</span
                              >
                              <span class="text-success"
                                >({{ tool.function.arguments }})</span
                              >
                            </div>
                          </div>

                          <div
                            v-else-if="message.role === 'tool'"
                            class="message tool msg-result"
                          >
                            <div
                              class="d-flex justify-content-between align-items-start"
                            >
                              <strong style="color: var(--theme-green)"
                                >‚úì Tool Result:</strong
                              >
                              <small class="text-muted"
                                >{{ formatTimestamp(message.timestamp) }}</small
                              >
                            </div>
                            <p style="white-space: pre-wrap">
                              {{ message.content }}
                            </p>
                          </div>
                        </template>

                        <div
                          v-if="!selectedTranscript.transcript || selectedTranscript.transcript.length === 0"
                          class="text-muted text-center mt-4"
                        >
                          Select a log to view transcript.
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div
          class="modal fade"
          :class="{ show: showCreateModal || showEditModal }"
          :style="{ display: (showCreateModal || showEditModal) ? 'block' : 'none' }"
          tabindex="-1"
        >
          <div class="modal-dialog modal-lg">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title">
                  {{ showEditModal ? 'Edit Client' : 'Create New Client' }}
                </h5>

                <div class="ms-auto d-flex align-items-center gap-3">
                  <button
                    type="submit"
                    form="clientForm"
                    class="btn btn-sm btn-edit"
                    :disabled="saving"
                  >
                    {{ saving ? 'SAVING...' : 'SAVE' }}
                  </button>

                  <button
                    type="button"
                    class="btn-close m-0"
                    @click="closeModal"
                  ></button>
                </div>
              </div>
              <div class="modal-body">
                <!-- Full-screen System Prompt Editor -->
                <div
                  v-if="systemPromptExpanded"
                  class="system-prompt-fullscreen"
                >
                  <div
                    class="d-flex justify-content-between align-items-center mb-3"
                  >
                    <h5 class="mb-0">System Prompt Editor</h5>
                    <button
                      type="button"
                      class="btn btn-outline-secondary btn-sm"
                      @click="toggleSystemPromptExpansion"
                    >
                      ‚Üê Back to Form
                    </button>
                  </div>
                  <textarea
                    v-model="clientForm.system_prompt"
                    class="form-control system-prompt-fullscreen-textarea"
                    rows="25"
                    placeholder="Enter your system prompt here..."
                  ></textarea>
                </div>

                <!-- Normal Form View -->
                <form v-else id="clientForm" @submit.prevent="saveClient">
                  <ul class="nav nav-tabs mb-3">
                    <li class="nav-item">
                      <a
                        class="nav-link"
                        :class="{ active: activeClientTab === 'basic' }"
                        href="#"
                        @click.prevent="activeClientTab = 'basic'"
                        >Basic Info</a
                      >
                    </li>
                    <li class="nav-item">
                      <a
                        class="nav-link"
                        :class="{ active: activeClientTab === 'ai' }"
                        href="#"
                        @click.prevent="activeClientTab = 'ai'"
                        >AI Config</a
                      >
                    </li>
                    <li class="nav-item">
                      <a
                        class="nav-link"
                        :class="{ active: activeClientTab === 'prompting' }"
                        href="#"
                        @click.prevent="activeClientTab = 'prompting'"
                        >Prompting</a
                      >
                    </li>
                    <li class="nav-item">
                      <a
                        class="nav-link"
                        :class="{ active: activeClientTab === 'tools' }"
                        href="#"
                        @click.prevent="activeClientTab = 'tools'"
                        >Tools</a
                      >
                    </li>
                  </ul>

                  <div class="tab-content">
                    <div v-if="activeClientTab === 'basic'">
                      <div class="row">
                        <div class="col-md-6">
                          <div class="mb-3">
                            <label class="form-label">Name *</label>
                            <input
                              v-model="clientForm.name"
                              type="text"
                              class="form-control"
                              required
                            />
                          </div>
                          <div class="mb-3">
                            <label class="form-label">Cell Phone</label>
                            <input
                              v-model="clientForm.cell"
                              type="text"
                              class="form-control"
                              disabled
                              placeholder="Pending Provisioning..."
                            />
                            <div class="form-text text-muted">
                              Phone numbers are claimed after initial setup and
                              payment.
                            </div>
                          </div>
                          <div class="mb-3">
                            <label class="form-label">Calendar ID</label>
                            <input
                              v-model="clientForm.calendar_id"
                              type="text"
                              class="form-control"
                            />
                          </div>

                          <!-- Calendar Authentication Section -->
                          <div v-if="showEditModal" class="mb-3">
                            <label class="form-label d-flex align-items-center">
                              <span>Calendar Authentication</span>
                              <small class="text-muted ms-2">(Optional - uses global fallback if not configured)</small>
                            </label>

                            <!-- Status Display -->
                            <div v-if="calendarAuthStatus.has_credentials" class="alert alert-success d-flex justify-content-between align-items-center">
                              <div>
                                <strong>‚úì Authenticated</strong>
                                <span v-if="calendarAuthStatus.credential_type === 'oauth'" class="badge bg-primary ms-2">OAuth 2.0</span>
                                <span v-else class="badge bg-info ms-2">Service Account</span>
                                <div class="small text-muted mt-1">
                                  <span v-if="calendarAuthStatus.service_account_email">
                                    {{ calendarAuthStatus.service_account_email }}
                                  </span>
                                  <span v-if="calendarAuthStatus.last_used_at">
                                    Last used: {{ new Date(calendarAuthStatus.last_used_at).toLocaleString() }}
                                  </span>
                                </div>
                              </div>
                              <button
                                @click="revokeCalendarCredentials"
                                class="btn btn-sm btn-outline-danger"
                                :disabled="revokingCredentials"
                              >
                                {{ revokingCredentials ? 'Revoking...' : 'Revoke' }}
                              </button>
                            </div>

                            <div v-else class="alert alert-info">
                              <strong>‚Ñπ No Authentication</strong>
                              <div class="small text-muted">
                                <span v-if="calendarAuthStatus.fallback_available">
                                  Using global service account fallback
                                </span>
                                <span v-else>
                                  No credentials configured
                                </span>
                              </div>
                            </div>

                            <!-- Auth Options (only show if no credentials) -->
                            <div v-if="!calendarAuthStatus.has_credentials" class="mt-2">
                              <!-- OAuth Button -->
                              <button
                                @click="initiateOAuthFlow"
                                class="btn btn-primary me-2"
                                :disabled="initiatingOAuth"
                              >
                                <span v-if="initiatingOAuth">
                                  <span class="spinner-border spinner-border-sm me-1"></span>
                                  Connecting...
                                </span>
                                <span v-else>
                                  üîê Connect with Google OAuth
                                </span>
                              </button>

                              <!-- Service Account Upload -->
                              <div class="d-inline-block">
                                <input
                                  type="file"
                                  ref="serviceAccountFile"
                                  @change="handleServiceAccountFileSelect"
                                  accept=".json,application/json"
                                  class="d-none"
                                  id="serviceAccountFileInput"
                                />
                                <label
                                  for="serviceAccountFileInput"
                                  class="btn btn-outline-secondary me-2 mb-0"
                                  :class="{ 'disabled': uploadingServiceAccount }"
                                >
                                  üìÑ Choose Service Account JSON
                                </label>
                                <span v-if="serviceAccountFile" class="small text-muted">
                                  {{ serviceAccountFile.name }}
                                </span>
                                <button
                                  v-if="serviceAccountFile"
                                  @click="uploadServiceAccount"
                                  class="btn btn-success"
                                  :disabled="uploadingServiceAccount"
                                >
                                  {{ uploadingServiceAccount ? 'Uploading...' : 'Upload' }}
                                </button>
                              </div>
                            </div>
                          </div>
                        </div>
                        <div class="col-md-6">
                          <div class="mb-3">
                            <label class="form-label">Business Timezone</label>
                            <select
                              v-model="clientForm.business_timezone"
                              class="form-select"
                            >
                              <option value="America/Los_Angeles">
                                America/Los_Angeles
                              </option>
                              <option value="America/New_York">
                                America/New_York
                              </option>
                              <option value="America/Chicago">
                                America/Chicago
                              </option>
                              <option value="America/Denver">
                                America/Denver
                              </option>
                            </select>
                          </div>
                          <div class="row">
                            <div class="col-md-6">
                              <div class="mb-3">
                                <label class="form-label">Start Hour</label>
                                <select
                                  v-model.number="clientForm.business_start_hour"
                                  class="form-select"
                                >
                                  <option
                                    v-for="h in 24"
                                    :key="h-1"
                                    :value="h-1"
                                  >
                                    {{ formatHour(h-1) }}
                                  </option>
                                </select>
                              </div>
                            </div>
                            <div class="col-md-6">
                              <div class="mb-3">
                                <label class="form-label">End Hour</label>
                                <select
                                  v-model.number="clientForm.business_end_hour"
                                  class="form-select"
                                >
                                  <option
                                    v-for="h in 24"
                                    :key="h-1"
                                    :value="h-1"
                                  >
                                    {{ formatHour(h-1) }}
                                  </option>
                                </select>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>

                    <div v-if="activeClientTab === 'ai'">
                      <div class="row">
                        <div class="col-md-6">
                          <div class="mb-3">
                            <label class="form-label">LLM Model</label>
                            <select
                              v-model="clientForm.llm_model"
                              class="form-select"
                            >
                              <option value="openai/gpt-4o-mini">
                                openai/gpt-4o-mini
                              </option>
                              <option value="anthropic/claude-3-haiku">
                                anthropic/claude-3-haiku
                              </option>
                              <option value="google/gemini-flash-1.5">
                                google/gemini-flash-1.5
                              </option>
                              <option value="x-ai/grok-4-fast">
                                x-ai/grok-4-fast
                              </option>
                            </select>
                          </div>
                          <div class="mb-3">
                            <label class="form-label">STT Model</label>
                            <select
                              v-model="clientForm.stt_model"
                              class="form-select"
                            >
                              <option value="nova-2-phonecall">
                                Deepgram Nova 2 Phonecall
                              </option>
                              <option value="nova-2-conversationalai">
                                Deepgram Nova 2 Conversational AI
                              </option>
                              <option value="nova-2-medical">
                                Deepgram Nova 2 Medical
                              </option>
                              <option value="nova-2-automotive">
                                Deepgram Nova 2 Automotive
                              </option>
                            </select>
                          </div>
                        </div>
                        <div class="col-md-6">
                          <div class="mb-3">
                            <label class="form-label">TTS Model</label>
                            <select
                              v-model="clientForm.tts_model"
                              class="form-select"
                            >
                              <option value="eleven_flash_v2_5">
                                ElevenLabs Flash v2.5
                              </option>
                              <option value="eleven_flash_v2">
                                ElevenLabs Flash v2
                              </option>
                              <option value="eleven_turbo_v2_5">
                                ElevenLabs Turbo v2.5
                              </option>
                              <option value="eleven_turbo_v2">
                                ElevenLabs Turbo v2
                              </option>
                            </select>
                          </div>
                          <div class="mb-3">
                            <label class="form-label">TTS Voice ID</label>

                            <div class="input-group">
                              <select
                                class="form-select"
                                style="max-width: 160px; border-right: none"
                                @change="clientForm.tts_voice_id = $event.target.value"
                              >
                                <option value="" disabled selected>
                                  Quick Fill...
                                </option>
                                <option
                                  v-for="voice in voicePresets"
                                  :key="voice.id"
                                  :value="voice.id"
                                >
                                  {{ voice.name }}
                                </option>
                              </select>

                              <input
                                v-model="clientForm.tts_voice_id"
                                type="text"
                                class="form-control"
                                placeholder="Paste ID here or select preset..."
                              />
                            </div>
                            <div class="form-text text-muted">
                              Select a preset to auto-fill, or paste a custom
                              Clone ID from ElevenLabs.
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>

                    <div v-if="activeClientTab === 'prompting'">
                      <div class="mb-3">
                        <label class="form-label">Use Template</label>
                        <select
                          v-model="selectedTemplate"
                          @change="applyTemplate"
                          class="form-select template-selector w-100"
                          style="max-width: none"
                        >
                          <option value="">Select Template</option>
                          <option
                            v-for="(template, key) in templates"
                            :key="key"
                            :value="key"
                          >
                            {{ template.name }}
                          </option>
                        </select>
                      </div>
                      <div class="mb-3">
                        <label class="form-label">Initial Greeting</label>
                        <textarea
                          v-model="clientForm.initial_greeting"
                          class="form-control"
                          rows="2"
                        ></textarea>
                      </div>
                      <div class="mb-3">
                        <label
                          class="form-label d-flex justify-content-between align-items-center"
                        >
                          System Prompt
                          <button
                            type="button"
                            class="btn btn-sm btn-outline-secondary"
                            @click="toggleSystemPromptExpansion"
                          >
                            Expand to Full Screen
                          </button>
                        </label>
                        <textarea
                          v-model="clientForm.system_prompt"
                          class="form-control"
                          rows="12"
                        ></textarea>
                      </div>
                    </div>

                    <div v-if="activeClientTab === 'tools'">
                      <div
                        class="p-4 border rounded"
                        style="
                          background: var(--theme-bg-dark);
                          border-color: var(--theme-bg-mid) !important;
                        "
                      >
                        <label
                          class="form-label mb-4 text-warning"
                          style="letter-spacing: 2px"
                          >>> ACTIVE CAPABILITIES</label
                        >

                        <div class="form-check mb-3">
                          <input
                            class="form-check-input"
                            type="checkbox"
                            v-model="clientForm.enable_scheduling"
                            id="bundle_scheduling"
                          />
                          <label
                            class="form-check-label fw-bold"
                            for="bundle_scheduling"
                            >Enable Scheduling</label
                          >
                          <div class="text-muted small ms-4 mt-1">
                            Allows the agent to check availability, book,
                            reschedule, and cancel appointments via Google
                            Calendar.
                          </div>
                        </div>

                        <hr class="border-secondary opacity-25 my-3" />

                        <div class="form-check">
                          <input
                            class="form-check-input"
                            type="checkbox"
                            v-model="clientForm.enable_contact_memory"
                            id="bundle_contact"
                          />
                          <label
                            class="form-check-label fw-bold"
                            for="bundle_contact"
                            >Contact Memory</label
                          >
                          <div class="text-muted small ms-4 mt-1">
                            Allows the agent to learn and save the caller's name
                            for future personalized greetings.
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </form>
              </div>
            </div>
          </div>
        </div>

        <!-- Top Up Modal -->
        <div
          class="modal fade"
          :class="{ show: showTopUpModal }"
          :style="{ display: showTopUpModal ? 'block' : 'none' }"
          tabindex="-1"
        >
          <div class="modal-dialog modal-lg">
            <div class="modal-content">
              <div
                class="modal-header"
              >
                <h5 class="modal-title">
                  <i class="bi bi-fuel-pump me-2"></i> REFUEL AGENT
                </h5>
                <button
                  type="button"
                  class="btn-close"
                  @click="closeTopUpModal"
                ></button>
              </div>
              <div class="modal-body p-4">
                <!-- Agent Info Bar -->
                <div v-if="selectedTopUpClient" class="mb-4 p-2 border border-opacity-0" style="background: rgba(255,255,255,0.02); font-family: 'JetBrains Mono', monospace; font-size: 0.85rem;">
                  <div class="d-flex justify-content-between align-items-center">
                    <div>
                      <span class="text-muted">AGENT:</span>
                      <span class="text-purple fw-bold ms-2">{{ selectedTopUpClient.name }}</span>
                    </div>
                    <div>
                      <span class="text-muted">BALANCE:</span>
                      <span class="text-fg fw-bold ms-2">{{ formatDuration(selectedTopUpClient.balance_seconds || 0) }}</span>
                    </div>
                  </div>
                </div>

                <!-- Pricing Table -->
                <div class="border border-opacity-0" style="background: rgba(255,255,255,0.02);">
                  <table class="table table-custom table-no-hover mb-0" style="border-spacing: 0 !important;">
                    <thead>
                      <tr>
                        <th style="width: 25%; border-bottom: 1px solid var(--theme-bg-mid) !important;">TIER</th>
                        <th style="width: 20%; border-bottom: 1px solid var(--theme-bg-mid) !important;">PRICE</th>
                        <th style="width: 20%; border-bottom: 1px solid var(--theme-bg-mid) !important;">MINUTES</th>
                        <th style="width: 20%; border-bottom: 1px solid var(--theme-bg-mid) !important;">RATE</th>
                        <th style="width: 15%; border-bottom: 1px solid var(--theme-bg-mid) !important;"></th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr style="background: transparent !important;">
                        <td class="text-muted" style="border: none !important;">BASIC</td>
                        <td class="text-fg fw-bold" style="border: none !important;">$10</td>
                        <td class="text-fg" style="border: none !important;">50</td>
                        <td class="text-muted" style="border: none !important;">$0.20/min</td>
                        <td style="border: none !important;">
                          <button
                            @click="initiateCheckout('topup_small')"
                            class="btn btn-sm btn-outline-secondary"
                            style="font-size: 0.7rem; padding: 0.25rem 0.75rem;"
                          >
                            SELECT
                          </button>
                        </td>
                      </tr>
                      <tr style="background: transparent !important;">
                        <td class="text-muted" style="border: none !important;">STANDARD</td>
                        <td class="text-fg fw-bold" style="border: none !important;">$20</td>
                        <td class="text-fg" style="border: none !important;">100</td>
                        <td class="text-muted" style="border: none !important;">$0.20/min</td>
                        <td style="border: none !important;">
                          <button
                            @click="initiateCheckout('topup_medium')"
                            class="btn btn-sm btn-outline-secondary"
                            style="font-size: 0.7rem; padding: 0.25rem 0.75rem;"
                          >
                            SELECT
                          </button>
                        </td>
                      </tr>
                      <tr style="background: transparent !important;">
                        <td style="border: none !important;">
                          <span class="text-muted">PREMIUM</span>
                          <span class="badge bg-success ms-2" style="font-size: 0.6rem; padding: 0.2rem 0.4rem;">BEST</span>
                        </td>
                        <td class="text-fg fw-bold" style="border: none !important;">$50</td>
                        <td class="text-fg" style="border: none !important;">500</td>
                        <td class="text-green" style="border: none !important;">$0.10/min</td>
                        <td style="border: none !important;">
                          <button
                            @click="initiateCheckout('topup_large')"
                            class="btn btn-sm btn-outline-secondary"
                            style="font-size: 0.7rem; padding: 0.25rem 0.75rem;"
                          >
                            SELECT
                          </button>
                        </td>
                      </tr>
                    </tbody>
                  </table>
                </div>

                <!-- Footer -->
                <div class="mt-3 p-2 border border-opacity-0" style="background: rgba(255,255,255,0.02);">
                  <div class="text-muted text-center" style="font-family: 'JetBrains Mono', monospace; font-size: 0.75rem;">
                    <i class="bi bi-lock-fill me-1"></i>
                    STRIPE ENCRYPTED CHECKOUT
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Settings Modal -->
        <div
          class="modal fade"
          :class="{ show: showSettingsModal }"
          :style="{ display: showSettingsModal ? 'block' : 'none' }"
          tabindex="-1"
        >
          <div class="modal-dialog modal-lg">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title">Settings</h5>

                <div class="ms-auto d-flex align-items-center">
                  <button
                    type="button"
                    class="btn-close m-0"
                    @click="closeSettingsModal"
                  ></button>
                </div>
              </div>
              <div class="modal-body">
                <div class="mb-4">
                  <label class="form-label text-blue mb-2">>> APPEARANCE</label>
                  <div
                    class="p-3 border rounded"
                    style="
                      border-color: var(--theme-bg-mid) !important;
                      background: var(--theme-bg-dark);
                    "
                  >
                    <label class="form-label small text-muted mb-1"
                      >THEME PRESET</label
                    >
                    <select
                      v-model="currentTheme"
                      @change="applyTheme(currentTheme)"
                      class="form-select form-select-sm"
                    >
                      <option
                        v-for="theme in themes"
                        :key="theme.key"
                        :value="theme.key"
                      >
                        {{ theme.name }}
                      </option>
                    </select>
                  </div>
                </div>

                <div class="mb-4">
                  <label class="form-label text-blue mb-2"
                    >>> DATA OPERATIONS</label
                  >
                  <div
                    class="p-3 border rounded"
                    style="
                      border-color: var(--theme-bg-mid) !important;
                      background: var(--theme-bg-dark);
                    "
                  >
                    <div
                      class="d-flex justify-content-between align-items-center mb-3 pb-3 border-bottom"
                      style="border-color: var(--theme-bg-mid) !important"
                    >
                      <div>
                        <span
                          class="text-fg d-block"
                          style="font-size: 0.85rem; letter-spacing: 1px"
                          >EXPORT DATABASE</span
                        >
                        <small class="text-muted" style="font-size: 0.7rem"
                          >Download full client list as JSON.</small
                        >
                      </div>
                      <button
                        @click="exportClients"
                        class="btn btn-sm btn-outline-info d-flex align-items-center gap-2"
                      >
                        <i class="bi bi-download"></i> DOWNLOAD
                      </button>
                    </div>

                    <div>
                      <span
                        class="text-fg d-block mb-2"
                        style="font-size: 0.85rem; letter-spacing: 1px"
                        >IMPORT CLIENTS (APPEND)</span
                      >
                      <div class="d-flex gap-2 align-items-center">
                        <input
                          type="file"
                          accept=".json"
                          @change="handleFileSelect"
                          class="form-control form-control-sm"
                          style="background: transparent"
                        />
                        <button
                          @click="executeImport"
                          class="btn btn-sm btn-outline-success d-flex align-items-center gap-2"
                          :disabled="!importFile"
                        >
                          <i class="bi bi-upload"></i> UPLOAD
                        </button>
                      </div>
                      <div class="mt-2 text-muted" style="font-size: 0.65rem">
                        * Skips existing IDs. Merges new data records only.
                      </div>
                    </div>
                  </div>
                </div>

                <div class="mb-4">
                  <label class="form-label text-blue mb-2"
                    >>> SYSTEM STATUS</label
                  >
                  <div
                    class="p-3 border rounded"
                    style="
                      border-color: var(--theme-bg-mid) !important;
                      background: var(--theme-bg-dark);
                    "
                  >
                    <div
                      class="d-flex justify-content-between align-items-center"
                    >
                      <div>
                        <span
                          class="text-danger d-block"
                          style="font-size: 0.85rem; letter-spacing: 1px"
                          >CLEAR SESSION</span
                        >
                        <small class="text-muted" style="font-size: 0.7rem"
                          >Logout and clear local tokens.</small
                        >
                      </div>
                      <button
                        class="btn btn-sm btn-outline-danger d-flex align-items-center gap-2"
                        onclick="
                          localStorage.clear();
                          location.reload();
                        "
                      >
                        <i class="bi bi-radioactive"></i> RESET
                      </button>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- User Profile Modal -->
      <div
        class="modal fade"
        :class="{ show: showUserProfileModal }"
        :style="{ display: showUserProfileModal ? 'block' : 'none' }"
        tabindex="-1"
      >
        <div class="modal-dialog">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title">>> USER PROFILE</h5>
              <button
                type="button"
                class="btn-close m-0"
                @click="showUserProfileModal = false"
              ></button>
            </div>
            <div class="modal-body">
              <form @submit.prevent="saveUserProfile">
                <div class="mb-3">
                  <label class="form-label text-muted small">EMAIL</label>
                  <input
                    type="email"
                    class="form-control"
                    :value="currentUser"
                    disabled
                  />
                  <div class="form-text text-muted small">
                    Email cannot be changed
                  </div>
                </div>

                <div class="mb-3">
                  <label class="form-label text-muted small">DISPLAY NAME</label>
                  <input
                    v-model="userProfile.displayName"
                    type="text"
                    class="form-control"
                    placeholder="Enter your display name..."
                  />
                </div>

                <div class="mb-4">
                  <label class="form-label text-blue">>> CHANGE PASSWORD</label>
                  <div class="mb-3">
                    <label class="form-label text-muted small">CURRENT PASSWORD</label>
                    <input
                      v-model="userProfile.currentPassword"
                      type="password"
                      class="form-control"
                      placeholder="Enter current password..."
                    />
                  </div>
                  <div class="mb-3">
                    <label class="form-label text-muted small">NEW PASSWORD</label>
                    <input
                      v-model="userProfile.newPassword"
                      type="password"
                      class="form-control"
                      placeholder="Enter new password..."
                    />
                  </div>
                  <div class="mb-3">
                    <label class="form-label text-muted small">CONFIRM NEW PASSWORD</label>
                    <input
                      v-model="userProfile.confirmPassword"
                      type="password"
                      class="form-control"
                      placeholder="Confirm new password..."
                    />
                  </div>
                </div>

                <div class="d-flex justify-content-between align-items-center">
                  <button
                    type="button"
                    class="btn btn-outline-danger"
                    @click="showUserProfileModal = false; logout()"
                  >
                    <i class="bi bi-box-arrow-right me-1"></i> LOGOUT
                  </button>
                  <div class="d-flex gap-2">
                    <button
                      type="button"
                      class="btn btn-outline-secondary"
                      @click="showUserProfileModal = false"
                    >
                      CANCEL
                    </button>
                    <button
                      type="submit"
                      class="btn btn-primary"
                      :disabled="savingProfile"
                    >
                      {{ savingProfile ? 'SAVING...' : 'SAVE CHANGES' }}
                    </button>
                  </div>
                </div>
              </form>
            </div>
          </div>
        </div>
      </div>

      <button
        v-if="currentView === 'dashboard' && activeTab === 'clients'"
        @click="showCreateModal = true"
        class="btn btn-fab"
        title="Create New Client"
      >
        +
      </button>

      <div id="auditLogModal" class="modal fade" tabindex="-1">
        <div class="modal-dialog modal-lg">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title">SYSTEM ACTIVITY LOG</h5>
              <button
                type="button"
                class="btn-close"
                @click="closeAuditLog"
              ></button>
            </div>
            <div class="modal-body p-0">
              <div class="terminal-console">
                <div v-if="auditLogs.length === 0" class="text-muted">
                  System silent. No activity recorded.
                </div>
                <div v-for="log in auditLogs" :key="log.id" class="log-entry">
                  <span class="log-timestamp"
                    >[{{ formatTimestamp(log.timestamp) }}]</span
                  >
                  <span
                    :class="log.type === 'create' ? 'text-success' : log.type === 'update' ? 'text-warning' : 'text-danger'"
                  >
                    [{{ log.type.toUpperCase() }}]
                  </span>
                  <span class="text-fg"> {{ log.action }}</span>
                </div>
              </div>
            </div>
            <div class="modal-footer">
              <button
                type="button"
                class="btn btn-outline-secondary"
                @click="closeAuditLog"
              >
                CLOSE
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
    <script src="app.js"></script>
  </body>
</html>
